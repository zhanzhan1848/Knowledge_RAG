# Knowledge RAG System

ä¸€ä¸ªåŸºäº FastAPI å¾®æœåŠ¡æ¶æ„çš„æ™ºèƒ½çŸ¥è¯†æ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRAGï¼‰ç³»ç»Ÿï¼Œæ”¯æŒå¤šç§æ–‡æ¡£æ ¼å¼å¤„ç†ã€å‘é‡åŒ–å­˜å‚¨ã€çŸ¥è¯†å›¾è°±æ„å»ºå’Œæ™ºèƒ½é—®ç­”ã€‚

## ğŸš€ é¡¹ç›®ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- **å¤šæ ¼å¼æ–‡æ¡£å¤„ç†**: æ”¯æŒ PDFã€Wordã€Excelã€PowerPointã€Markdownã€HTML ç­‰æ ¼å¼
- **æ™ºèƒ½æ–‡æ¡£è§£æ**: åŸºäº OCR å’Œ NLP çš„æ–‡æ¡£å†…å®¹æå–å’Œç»“æ„åŒ–
- **å‘é‡åŒ–å­˜å‚¨**: é›†æˆ ChromaDBã€FAISSã€Weaviate ç­‰å‘é‡æ•°æ®åº“
- **çŸ¥è¯†å›¾è°±**: åŸºäº Neo4j çš„å®ä½“å…³ç³»æŠ½å–å’Œå›¾è°±æ„å»º
- **å¤šæ¨¡å‹æ”¯æŒ**: é›†æˆ OpenAIã€Anthropicã€æœ¬åœ°æ¨¡å‹ç­‰å¤šç§ LLM
- **æ™ºèƒ½é—®ç­”**: åŸºäºæ£€ç´¢å¢å¼ºç”Ÿæˆçš„é«˜è´¨é‡é—®ç­”ç³»ç»Ÿ
- **å®æ—¶å¤„ç†**: å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—å’Œå®æ—¶æ–‡æ¡£å¤„ç†

### æŠ€æœ¯æ¶æ„
- **å¾®æœåŠ¡æ¶æ„**: åŸºäº FastAPI çš„æ¾è€¦åˆå¾®æœåŠ¡è®¾è®¡
- **å®¹å™¨åŒ–éƒ¨ç½²**: Docker å’Œ Docker Compose æ”¯æŒ
- **æ•°æ®åº“æ”¯æŒ**: PostgreSQLã€Redisã€Elasticsearchã€Neo4j
- **æ¶ˆæ¯é˜Ÿåˆ—**: RabbitMQ å’Œ Celery å¼‚æ­¥ä»»åŠ¡å¤„ç†
- **ç›‘æ§ä½“ç³»**: Prometheus + Grafana å®Œæ•´ç›‘æ§æ–¹æ¡ˆ
- **CI/CD**: GitHub Actions è‡ªåŠ¨åŒ–éƒ¨ç½²æµæ°´çº¿

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Frontend UI   â”‚    â”‚   Mobile App    â”‚    â”‚  Third Party    â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚   Integration   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                      â”‚                      â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   API Gateway   â”‚
                    â”‚   (Kong/Nginx)  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                     â”‚                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚ Auth Service   â”‚    â”‚Document Service â”‚    â”‚ QA Service  â”‚
â”‚   (FastAPI)    â”‚    â”‚   (FastAPI)     â”‚    â”‚ (FastAPI)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
        â”‚                     â”‚                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚Vector Service  â”‚    â”‚  LLM Service    â”‚    â”‚Knowledge    â”‚
â”‚   (FastAPI)    â”‚    â”‚   (FastAPI)     â”‚    â”‚Graph Serviceâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
        â”‚                     â”‚                     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                         â”‚                         â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”
â”‚PostgreSQLâ”‚ â”‚   Redis   â”‚ â”‚ Neo4j  â”‚ â”‚Elasticsearchâ”‚ â”‚RabbitMQâ”‚
â”‚          â”‚ â”‚           â”‚ â”‚        â”‚ â”‚           â”‚ â”‚        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### åç«¯æœåŠ¡
- **Webæ¡†æ¶**: FastAPI 0.104+
- **å¼‚æ­¥è¿è¡Œæ—¶**: Uvicorn
- **æ•°æ®åº“ORM**: SQLAlchemy 2.0 (å¼‚æ­¥)
- **æ•°æ®åº“è¿ç§»**: Alembic
- **ä»»åŠ¡é˜Ÿåˆ—**: Celery + Redis
- **ç¼“å­˜**: Redis

### æ•°æ®å­˜å‚¨
- **å…³ç³»æ•°æ®åº“**: PostgreSQL 15
- **å‘é‡æ•°æ®åº“**: ChromaDB, FAISS
- **å›¾æ•°æ®åº“**: Neo4j 5.14
- **æœç´¢å¼•æ“**: Elasticsearch 8.11
- **æ¶ˆæ¯é˜Ÿåˆ—**: RabbitMQ 3.12

### AI/ML ç»„ä»¶
- **LLMé›†æˆ**: OpenAI GPT, Anthropic Claude
- **åµŒå…¥æ¨¡å‹**: Sentence Transformers
- **æ–‡æ¡£å¤„ç†**: PyPDF2, python-docx, BeautifulSoup
- **NLPå¤„ç†**: spaCy, NLTK

### å¼€å‘å·¥å…·
- **ä»£ç è´¨é‡**: Black, isort, Flake8, MyPy
- **æµ‹è¯•æ¡†æ¶**: Pytest, pytest-asyncio
- **å®‰å…¨æ‰«æ**: Bandit, Trivy
- **å®¹å™¨åŒ–**: Docker, Docker Compose
- **CI/CD**: GitHub Actions

### ç›‘æ§è¿ç»´
- **æŒ‡æ ‡ç›‘æ§**: Prometheus
- **å¯è§†åŒ–**: Grafana
- **é“¾è·¯è¿½è¸ª**: Jaeger
- **æ—¥å¿—ç®¡ç†**: Structured Logging

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Python 3.10+
- uv åŒ…ç®¡ç†å™¨ (æ¨è) æˆ– pip
- Docker 20.0+
- Docker Compose 2.0+
- Git

### 1. å…‹éš†é¡¹ç›®
```bash
git clone https://github.com/your-org/knowledge-rag.git
cd knowledge-rag
```

### 2. ç¯å¢ƒé…ç½®
```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.template .env

# ç¼–è¾‘ç¯å¢ƒå˜é‡ï¼ˆå¿…é¡»é…ç½® LLM API Keysï¼‰
vim .env
```

### 3. å¯åŠ¨æœåŠ¡
```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

### 4. éªŒè¯éƒ¨ç½²
```bash
# æ£€æŸ¥ API ç½‘å…³å¥åº·çŠ¶æ€
curl http://localhost:8000/health

# è®¿é—® API æ–‡æ¡£
open http://localhost:8000/docs

# è®¿é—®ç›‘æ§é¢æ¿
open http://localhost:3000  # Grafana (admin/admin123)
open http://localhost:9090  # Prometheus
```

## ğŸ“š æœåŠ¡ç«¯å£

| æœåŠ¡ | ç«¯å£ | æè¿° |
|------|------|------|
| API Gateway | 8000 | ä¸»è¦ API å…¥å£ |
| Auth Service | 8001 | ç”¨æˆ·è®¤è¯æœåŠ¡ |
| Document Service | 8002 | æ–‡æ¡£å¤„ç†æœåŠ¡ |
| Vector Service | 8003 | å‘é‡åŒ–æœåŠ¡ |
| LLM Service | 8004 | å¤§è¯­è¨€æ¨¡å‹æœåŠ¡ |
| QA Service | 8005 | é—®ç­”æœåŠ¡ |
| Knowledge Graph | 8006 | çŸ¥è¯†å›¾è°±æœåŠ¡ |
| Notification | 8007 | é€šçŸ¥æœåŠ¡ |
| PostgreSQL | 5432 | ä¸»æ•°æ®åº“ |
| Redis | 6379 | ç¼“å­˜å’Œæ¶ˆæ¯é˜Ÿåˆ— |
| Elasticsearch | 9200 | å…¨æ–‡æœç´¢ |
| Neo4j | 7474/7687 | å›¾æ•°æ®åº“ |
| RabbitMQ | 5672/15672 | æ¶ˆæ¯é˜Ÿåˆ— |
| Prometheus | 9090 | ç›‘æ§æŒ‡æ ‡ |
| Grafana | 3000 | ç›‘æ§é¢æ¿ |

## ğŸ”§ å¼€å‘æŒ‡å—

### æœ¬åœ°å¼€å‘ç¯å¢ƒ
```bash
# ä½¿ç”¨ uv åˆ›å»ºè™šæ‹Ÿç¯å¢ƒå’Œå®‰è£…ä¾èµ– (æ¨è)
uv sync --dev

# æˆ–è€…ä½¿ç”¨ä¼ ç»Ÿæ–¹å¼
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv
source venv/bin/activate  # Linux/Mac
# æˆ–
venv\Scripts\activate     # Windows

# å®‰è£…å¼€å‘ä¾èµ–
uv pip install -r requirements-dev.txt

# å®‰è£… pre-commit é’©å­
pre-commit install

# è¿è¡Œä»£ç æ ¼å¼åŒ–
black .
isort .

# è¿è¡Œç±»å‹æ£€æŸ¥
mypy services/ shared/ libs/

# è¿è¡Œæµ‹è¯•
pytest tests/ -v --cov
```

### æ·»åŠ æ–°æœåŠ¡
1. åœ¨ `services/` ç›®å½•ä¸‹åˆ›å»ºæ–°æœåŠ¡ç›®å½•
2. å¤åˆ¶ç°æœ‰æœåŠ¡çš„ç»“æ„å’Œ Dockerfile
3. æ›´æ–° `docker-compose.yml` æ·»åŠ æ–°æœåŠ¡é…ç½®
4. æ›´æ–° `pyproject.toml` æ·»åŠ æœåŠ¡ç‰¹å®šä¾èµ–
5. ç¼–å†™æœåŠ¡ä»£ç å’Œæµ‹è¯•

### æ•°æ®åº“è¿ç§»
```bash
# ç”Ÿæˆè¿ç§»æ–‡ä»¶
alembic revision --autogenerate -m "æè¿°å˜æ›´"

# åº”ç”¨è¿ç§»
alembic upgrade head

# å›æ»šè¿ç§»
alembic downgrade -1
```

## ğŸ§ª æµ‹è¯•

### è¿è¡Œæµ‹è¯•å¥—ä»¶
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest

# è¿è¡Œå•å…ƒæµ‹è¯•
pytest tests/unit/ -v

# è¿è¡Œé›†æˆæµ‹è¯•
pytest tests/integration/ -v

# è¿è¡Œç«¯åˆ°ç«¯æµ‹è¯•
pytest tests/e2e/ -v

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
pytest --cov=services --cov=shared --cov=libs --cov-report=html
```

### æ€§èƒ½æµ‹è¯•
```bash
# ä½¿ç”¨ Locust è¿›è¡Œè´Ÿè½½æµ‹è¯•
locust -f tests/performance/locustfile.py --host=http://localhost:8000
```

## ğŸ“Š ç›‘æ§å’Œè¿ç»´

### ç›‘æ§æŒ‡æ ‡
- **åº”ç”¨æŒ‡æ ‡**: è¯·æ±‚é‡ã€å“åº”æ—¶é—´ã€é”™è¯¯ç‡
- **ç³»ç»ŸæŒ‡æ ‡**: CPUã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œä½¿ç”¨ç‡
- **ä¸šåŠ¡æŒ‡æ ‡**: æ–‡æ¡£å¤„ç†é‡ã€é—®ç­”å‡†ç¡®ç‡ã€ç”¨æˆ·æ´»è·ƒåº¦

### æ—¥å¿—ç®¡ç†
- ç»“æ„åŒ–æ—¥å¿—è¾“å‡ºï¼ˆJSON æ ¼å¼ï¼‰
- åˆ†çº§æ—¥å¿—è®°å½•ï¼ˆDEBUGã€INFOã€WARNINGã€ERRORï¼‰
- é›†ä¸­åŒ–æ—¥å¿—æ”¶é›†å’Œåˆ†æ

### å¥åº·æ£€æŸ¥
æ¯ä¸ªæœåŠ¡éƒ½æä¾› `/health` ç«¯ç‚¹ç”¨äºå¥åº·æ£€æŸ¥ï¼ŒåŒ…æ‹¬ï¼š
- æœåŠ¡çŠ¶æ€
- æ•°æ®åº“è¿æ¥çŠ¶æ€
- å¤–éƒ¨ä¾èµ–çŠ¶æ€
- èµ„æºä½¿ç”¨æƒ…å†µ

## ğŸ”’ å®‰å…¨è€ƒè™‘

### è®¤è¯å’Œæˆæƒ
- JWT Token è®¤è¯
- RBAC è§’è‰²æƒé™æ§åˆ¶
- API å¯†é’¥ç®¡ç†
- OAuth 2.0 é›†æˆ

### æ•°æ®å®‰å…¨
- æ•°æ®åº“è¿æ¥åŠ å¯†
- æ•æ„Ÿæ•°æ®è„±æ•
- æ–‡ä»¶ä¸Šä¼ å®‰å…¨æ£€æŸ¥
- API è®¿é—®é™æµ

### ç½‘ç»œå®‰å…¨
- HTTPS å¼ºåˆ¶ä½¿ç”¨
- CORS è·¨åŸŸé…ç½®
- é˜²ç«å¢™è§„åˆ™
- å®¹å™¨ç½‘ç»œéš”ç¦»

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### ç¼“å­˜ç­–ç•¥
- Redis å¤šçº§ç¼“å­˜
- æŸ¥è¯¢ç»“æœç¼“å­˜
- å‘é‡æ£€ç´¢ç¼“å­˜
- CDN é™æ€èµ„æºç¼“å­˜

### æ•°æ®åº“ä¼˜åŒ–
- è¿æ¥æ± é…ç½®
- ç´¢å¼•ä¼˜åŒ–
- æŸ¥è¯¢ä¼˜åŒ–
- è¯»å†™åˆ†ç¦»

### å¼‚æ­¥å¤„ç†
- å¼‚æ­¥ I/O æ“ä½œ
- åå°ä»»åŠ¡é˜Ÿåˆ—
- æ‰¹é‡å¤„ç†ä¼˜åŒ–
- æµå¼æ•°æ®å¤„ç†

## ğŸ¤ è´¡çŒ®æŒ‡å—

### å¼€å‘æµç¨‹
1. Fork é¡¹ç›®åˆ°ä¸ªäººä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤å˜æ›´ (`git commit -m 'Add amazing feature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. åˆ›å»º Pull Request

### ä»£ç è§„èŒƒ
- éµå¾ª PEP 8 Python ä»£ç è§„èŒƒ
- ä½¿ç”¨ Black è¿›è¡Œä»£ç æ ¼å¼åŒ–
- ç¼–å†™å®Œæ•´çš„ç±»å‹æ³¨è§£
- æ·»åŠ è¯¦ç»†çš„æ–‡æ¡£å­—ç¬¦ä¸²
- ä¿æŒæµ‹è¯•è¦†ç›–ç‡ > 80%

### æäº¤è§„èŒƒ
ä½¿ç”¨ [Conventional Commits](https://www.conventionalcommits.org/) è§„èŒƒï¼š
- `feat:` æ–°åŠŸèƒ½
- `fix:` é”™è¯¯ä¿®å¤
- `docs:` æ–‡æ¡£æ›´æ–°
- `style:` ä»£ç æ ¼å¼è°ƒæ•´
- `refactor:` ä»£ç é‡æ„
- `test:` æµ‹è¯•ç›¸å…³
- `chore:` æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ GPL-3.0 è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

### è®¸å¯è¯è¯´æ˜
æœ¬é¡¹ç›®ä½¿ç”¨ GPL-3.0 è®¸å¯è¯ï¼Œä¸»è¦åŸå› æ˜¯é›†æˆäº†ä»¥ä¸‹ç»„ä»¶ï¼š
- **Neo4j**: å›¾æ•°æ®åº“ï¼Œé‡‡ç”¨ GPL-3.0 è®¸å¯è¯
- **Weaviate**: å‘é‡æ•°æ®åº“ï¼Œé‡‡ç”¨ BSD-3-Clause è®¸å¯è¯ï¼ˆä¸ GPL-3.0 å…¼å®¹ï¼‰

æ ¹æ® GPL-3.0 çš„è¦æ±‚ï¼Œä»»ä½•åŸºäºæœ¬é¡¹ç›®çš„è¡ç”Ÿä½œå“ä¹Ÿå¿…é¡»é‡‡ç”¨ GPL-3.0 æˆ–å…¼å®¹çš„è®¸å¯è¯å¼€æºã€‚

## ğŸ™‹â€â™‚ï¸ æ”¯æŒ

### æ–‡æ¡£
- [API æ–‡æ¡£](http://localhost:8000/docs)
- [æ¶æ„è®¾è®¡](docs/architecture.md)
- [éƒ¨ç½²æŒ‡å—](docs/deployment.md)
- [å¼€å‘æŒ‡å—](docs/development.md)

### ç¤¾åŒº
- [GitHub Issues](https://github.com/your-org/knowledge-rag/issues)
- [GitHub Discussions](https://github.com/your-org/knowledge-rag/discussions)
- [Wiki](https://github.com/your-org/knowledge-rag/wiki)

### è”ç³»æ–¹å¼
- é‚®ç®±: 270428890@qq.com
- å®˜ç½‘: https://no_net_now.knowledge-rag.com

---

**Knowledge RAG System** - è®©çŸ¥è¯†æ›´æ™ºèƒ½ï¼Œè®©é—®ç­”æ›´ç²¾å‡† ğŸš€